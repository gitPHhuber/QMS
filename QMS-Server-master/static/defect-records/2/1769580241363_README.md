# MABON ‚Äî Luxury Porcelain & Sculpture

–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –¥–∏–∑–∞–π–Ω–µ—Ä—Å–∫–æ–≥–æ —Ñ–∞—Ä—Ñ–æ—Ä–∞ –∏ —Å–∫—É–ª—å–ø—Ç—É—Ä. React + Node.js + PostgreSQL.

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Mabon_Luxury/
‚îú‚îÄ‚îÄ src/                    # Frontend (React + TypeScript)
‚îÇ   ‚îú‚îÄ‚îÄ components/         # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ pages/              # –°—Ç—Ä–∞–Ω–∏—Ü—ã
‚îÇ   ‚îú‚îÄ‚îÄ context/            # React –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ api/                # API –∫–ª–∏–µ–Ω—Ç
‚îú‚îÄ‚îÄ mabon-backend/          # Backend (Node.js + Express)
‚îÇ   ‚îú‚îÄ‚îÄ controllers/        # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ models/             # Sequelize –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ routes/             # –†–æ—É—Ç—ã API
‚îÇ   ‚îú‚îÄ‚îÄ middleware/         # JWT, —Ä–æ–ª–∏, –æ—à–∏–±–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ static/             # –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ docker-compose.yml      # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ nginx.conf              # Nginx –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
‚îî‚îÄ‚îÄ Dockerfile              # Frontend —Å–±–æ—Ä–∫–∞
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Docker)

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫

```bash
git clone <repo-url>
cd Mabon_Luxury

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d --build
```

### 2. –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ

- **–°–∞–π—Ç:** http://localhost:3001
- **API:** http://localhost:5000/api

### 3. –í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω

- **Email:** `admin@mabon.local`
- **–ü–∞—Ä–æ–ª—å:** `Mabon_Super_Secret_2025!`

---

## üíª –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (–±–µ–∑ Docker)

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 20+
- PostgreSQL 15+
- npm –∏–ª–∏ yarn

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
# –°–æ–∑–¥–∞—Ç—å –ë–î
psql -U postgres -c "CREATE DATABASE mabon;"
```

### 2. Backend

```bash
cd mabon-backend

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env (—Å–º. —Ä–∞–∑–¥–µ–ª –Ω–∏–∂–µ)
cp .env.example .env
nano .env

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
npm run dev
```

Backend –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ http://localhost:5000

### 3. Frontend

```bash
# –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
npm install

# –ó–∞–ø—É—Å—Ç–∏—Ç—å dev-—Å–µ—Ä–≤–µ—Ä
npm run dev
```

Frontend –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ http://localhost:5173

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Backend: `mabon-backend/.env`

```env
# ===== –°–ï–†–í–ï–† =====
PORT=5000

# ===== –ë–ê–ó–ê –î–ê–ù–ù–´–• =====
DB_HOST=localhost          # –î–ª—è Docker: db
DB_PORT=5432               # –õ–æ–∫–∞–ª—å–Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å 5435
DB_NAME=mabon
DB_USER=postgres
DB_PASSWORD=your_password  # ‚ö†Ô∏è –ò–ó–ú–ï–ù–ò–¢–¨ –í –ü–†–û–î–ï

# ===== –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ =====
JWT_SECRET=your_jwt_secret_min_32_chars    # ‚ö†Ô∏è –ò–ó–ú–ï–ù–ò–¢–¨ –í –ü–†–û–î–ï
SECRET_KEY=your_secret_key_min_32_chars    # ‚ö†Ô∏è –ò–ó–ú–ï–ù–ò–¢–¨ –í –ü–†–û–î–ï

# ===== CORS =====
CORS_ORIGINS=http://localhost:5173,http://localhost:3000

# ===== YOOKASSA (–û–ü–õ–ê–¢–ê) =====
YOOKASSA_SHOP_ID=123456                    # –í–∞—à Shop ID
YOOKASSA_SECRET_KEY=test_xxxxx             # –¢–µ—Å—Ç–æ–≤—ã–π –∏–ª–∏ –±–æ–µ–≤–æ–π –∫–ª—é—á

# ===== –ê–î–ú–ò–ù (—Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ) =====
ADMIN_EMAIL=admin@mabon.local
ADMIN_PASSWORD=Strong_Password_123!        # ‚ö†Ô∏è –ò–ó–ú–ï–ù–ò–¢–¨ –í –ü–†–û–î–ï

# ===== SEQUELIZE =====
DB_SYNC_ALTER=true         # true –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, false –¥–ª—è –ø—Ä–æ–¥–∞
```

### Frontend: –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
VITE_API_BASE_URL=http://localhost:5000
```

–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:

```env
VITE_API_BASE_URL=https://api.your-domain.com
```

---

## üåê –î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω

### –í–∞—Ä–∏–∞–Ω—Ç 1: Docker Compose –Ω–∞ VPS

#### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker –∏ Docker Compose
curl -fsSL https://get.docker.com | sh
sudo usermod -aG docker $USER
```

#### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

–°–æ–∑–¥–∞–π—Ç–µ `docker-compose.prod.yml`:

```yaml
services:
  db:
    image: postgres:15-alpine
    container_name: mabon_db
    restart: always
    environment:
      POSTGRES_USER: mabon_user
      POSTGRES_PASSWORD: ${DB_PASSWORD}  # –ò–∑ .env
      POSTGRES_DB: mabon
    volumes:
      - postgres_data:/var/lib/postgresql/data

  backend:
    build: ./mabon-backend
    container_name: mabon_backend
    restart: always
    depends_on:
      - db
    environment:
      PORT: 5000
      DB_HOST: db
      DB_PORT: 5432
      DB_NAME: mabon
      DB_USER: mabon_user
      DB_PASSWORD: ${DB_PASSWORD}
      JWT_SECRET: ${JWT_SECRET}
      SECRET_KEY: ${SECRET_KEY}
      CORS_ORIGINS: https://your-domain.com
      YOOKASSA_SHOP_ID: ${YOOKASSA_SHOP_ID}
      YOOKASSA_SECRET_KEY: ${YOOKASSA_SECRET_KEY}
      ADMIN_EMAIL: ${ADMIN_EMAIL}
      ADMIN_PASSWORD: ${ADMIN_PASSWORD}
      DB_SYNC_ALTER: "false"
    volumes:
      - ./mabon-backend/static:/app/static

  frontend:
    build:
      context: .
      args:
        VITE_API_BASE_URL: https://your-domain.com
    container_name: mabon_frontend
    restart: always
    depends_on:
      - backend
    ports:
      - "80:80"
      - "443:443"

volumes:
  postgres_data:
```

#### 3. –°–æ–∑–¥–∞–π—Ç–µ `.env` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```env
DB_PASSWORD=SuperSecurePassword123!
JWT_SECRET=your_very_long_jwt_secret_at_least_32_characters
SECRET_KEY=your_very_long_secret_key_at_least_32_characters
YOOKASSA_SHOP_ID=123456
YOOKASSA_SECRET_KEY=live_xxxxxxxxxxxxx
ADMIN_EMAIL=admin@your-domain.com
ADMIN_PASSWORD=AdminSecurePassword456!
```

#### 4. –ó–∞–ø—É—Å–∫

```bash
docker-compose -f docker-compose.prod.yml up -d --build
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

#### Backend –Ω–∞ VPS / Cloud Run / Railway

```bash
cd mabon-backend
npm install --production
npm start
```

#### Frontend –Ω–∞ Vercel / Netlify / Cloudflare Pages

```bash
npm run build
# –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–∞–ø–∫—É dist/
```

---

## üîê –ß—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------------|----------|--------|
| `DB_PASSWORD` | –ü–∞—Ä–æ–ª—å –ë–î | `Kj8#mNp$2qLx` |
| `JWT_SECRET` | –°–µ–∫—Ä–µ—Ç –¥–ª—è JWT —Ç–æ–∫–µ–Ω–æ–≤ (–º–∏–Ω. 32 —Å–∏–º–≤–æ–ª–∞) | `a1b2c3d4e5f6g7h8i9j0...` |
| `SECRET_KEY` | –û–±—â–∏–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á | `x9y8z7w6v5u4t3s2r1q0...` |
| `ADMIN_PASSWORD` | –ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ | `Admin$ecure2025!` |
| `YOOKASSA_SECRET_KEY` | –ë–æ–µ–≤–æ–π –∫–ª—é—á –ÆKassa | `live_xxxxxxxxxxxx` |
| `CORS_ORIGINS` | –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã | `https://mabon.ru` |

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∫–ª—é—á–µ–π

```bash
# JWT_SECRET –∏ SECRET_KEY
openssl rand -base64 32

# –ò–ª–∏ —á–µ—Ä–µ–∑ Node.js
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

---

## üìù API Endpoints

### –ü—É–±–ª–∏—á–Ω—ã–µ

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/api/product` | –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ |
| GET | `/api/product/:id` | –¢–æ–≤–∞—Ä –ø–æ ID |
| GET | `/api/author` | –°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–æ–≤ |
| GET | `/api/author/:id` | –ê–≤—Ç–æ—Ä –ø–æ ID |
| GET | `/api/arttype` | –¢–∏–ø—ã –∏—Å–∫—É—Å—Å—Ç–≤–∞ |
| GET | `/api/review/product/:id` | –û—Ç–∑—ã–≤—ã —Ç–æ–≤–∞—Ä–∞ |

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| POST | `/api/user/registration` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è |
| POST | `/api/user/login` | –í—Ö–æ–¥ |
| GET | `/api/user/auth` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ |

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—Ç—Ä–µ–±—É–µ—Ç JWT)

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/api/cart` | –ö–æ—Ä–∑–∏–Ω–∞ |
| POST | `/api/cart` | –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É |
| DELETE | `/api/cart/:id` | –£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã |
| GET | `/api/wishlist` | –ò–∑–±—Ä–∞–Ω–Ω–æ–µ |
| POST | `/api/order` | –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ |
| GET | `/api/order/my` | –ú–æ–∏ –∑–∞–∫–∞–∑—ã |

### –ê–¥–º–∏–Ω (—Ç—Ä–µ–±—É–µ—Ç JWT + —Ä–æ–ª—å ADMIN)

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| POST | `/api/product` | –°–æ–∑–¥–∞—Ç—å —Ç–æ–≤–∞—Ä |
| PUT | `/api/product/:id` | –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–≤–∞—Ä |
| DELETE | `/api/product/:id` | –£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä |
| GET | `/api/order` | –í—Å–µ –∑–∞–∫–∞–∑—ã |
| PUT | `/api/order/:id` | –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ |

---

## üí≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ÆKassa

### –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –≤ [–ÆKassa](https://yookassa.ru/)
2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ
3. –£–∫–∞–∂–∏—Ç–µ –≤ `.env`:

```env
YOOKASSA_SHOP_ID=123456
YOOKASSA_SECRET_KEY=test_xxxxxxxxxxxxxxxx
```

### –ë–æ–µ–≤–æ–π —Ä–µ–∂–∏–º

1. –ü—Ä–æ–π–¥–∏—Ç–µ –º–æ–¥–µ—Ä–∞—Ü–∏—é –≤ –ÆKassa
2. –ó–∞–º–µ–Ω–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∫–ª—é—á –Ω–∞ –±–æ–µ–≤–æ–π:

```env
YOOKASSA_SECRET_KEY=live_xxxxxxxxxxxxxxxx
```

### Webhook –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤ –æ–ø–ª–∞—Ç—ã

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –ÆKassa:

```
URL: https://your-domain.com/api/yookassa/webhook
–ú–µ—Ç–æ–¥: POST
```

---

## üõ† –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose up -d --build

# –õ–æ–≥–∏
docker-compose logs -f backend
docker-compose logs -f frontend

# –ó–∞–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ë–î
docker exec -it mabon_db psql -U postgres -d mabon

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart backend

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–≤–∫–ª—é—á–∞—è volumes)
docker-compose down -v
```

---

## üêõ –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### CORS –æ—à–∏–±–∫–∏

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ `CORS_ORIGINS` –≤ `.env` ‚Äî –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–æ–º–µ–Ω —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞.

### –ù–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–¥–º–∏–Ω

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `ADMIN_EMAIL` –∏ `ADMIN_PASSWORD` –∑–∞–¥–∞–Ω—ã –¥–æ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞.

### –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DB_HOST` (–¥–ª—è Docker: `db`, –ª–æ–∫–∞–ª—å–Ω–æ: `localhost`)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç (`5432` –≤ Docker, –º–æ–∂–µ—Ç –±—ã—Ç—å `5435` –ª–æ–∫–∞–ª—å–Ω–æ)

### –ö–∞—Ä—Ç–∏–Ω–∫–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ volume –¥–ª—è static —Ñ–∞–π–ª–æ–≤:

```yaml
volumes:
  - ./mabon-backend/static:/app/static
```

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT